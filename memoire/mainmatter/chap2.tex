\chapter{Méthode d'ordre élevé pour le suivi d'un carreau de surface}%patch surfacique rectangulaire}
\label{chap:methode_ps}

\textit{on veut mettre au point une méthode numérique (discrétisations spatiale et temporelle) pour le suivi d'un seul patch rectangulaire de surface de continuité géométrique élevée (infinie), qui servira de base pour  mettre en \oe uvre l'algorithme du \autoref{chap:algo_general}}
\par\bigskip

suivi lagrangien de marqueurs/points de collocation situés sur la surface

\section{Discrétisation spectrale en espace}%spatiale}
méthode pseudo-spectrale : solution développée dans une base de fonctions globales et régulières, résidu annulé exactement en un nombre discret de points de collocation, donnant une EDO en temps par point de collocation\par
Choix des fonctions de base et des marqueurs/points de collocation\par

\subsection{État de l'art}
Le choix des fonction de base se pose alors. Celles-ci doivent pouvoir représenter n'importe quel type de solution avec une précision arbitraire, offrir une convergence rapide à mesure que le nombre de degrés de liberté augmente et enfin pouvoir être évaluées efficacement. A ces critères s'ajoutent également des contraintes liées à la topologie de la solution (i.e. l'interface en propagation).\par

Traditionnellement, les méthodes spectrales reposent sur les séries de Fourier lorsque la solution est spatialement périodique. 
Les polynômes trigonométriques ont ainsi été utilisés comme fonctions de base pour représenter un front de flamme dans une configuration quasi-3{\scshape d} \cite{gueyffier2015} (\textbf{reformuler}).
Lorsque la solution est une surface fermée de genre zéro (\ie\ une sphère topologique), la base des harmoniques sphériques est particulièrement adaptée \cite{veerapaneni2011}.\par
Les travaux de Bruno \cite{bruno2007} sur une méthode de \eng{continuation} ont permis d'étendre l'usage des polynômes trigonométriques aux surfaces homéomorphes à des disques. 
Cette approche permet de représenter des surfaces de géométrie complexe et de topologie arbitraire en raccordant des patchs locaux à l'aide de partitions de l'unité.\\
\textbf{Permet d'éviter Gibbs dans le cas régulier par morceaux}\\
A l'instar de la méthode proposée dans cette thèse, l'idée est alors de représenter des surfaces de géométrie complexe et de topologie arbitraire à l'aide de paramétrisations locales en construisant un atlas. 
En revanche, cette approche nécessite la résolution de systèmes linéaires mettant en jeu des matrices de grande taille, pleines et généralement mal conditionnées. 
En outre, cette méthode n'a à ce jour pas été appliquée pour la déformation de surface.
%Ce type de discrétisation spectrale a notamment été utilisé pour la représentation de vésicules inextensibles en suspension dans un écoulement fortement visqueux \cite{veerapaneni2011}. 
%Dans ces travaux, la base des harmoniques sphériques est naturellement adaptée à la topologie des vésicules (genre 0 sans bord).
%Les polynômes trigonométriques ont également été utilisés comme fonctions de base pour représenter un front de flamme une configuration quasi-3{\scshape d} \cite{gueyffier2015}.

\begin{itemize}
	\item harmoniques sphériques \cite{veerapaneni2011}, polynômes trigonométriques \cite{gueyffier2015} $\to$ contraintes topologiques (genre 0, sans bord ou périodique) (méthode de continuation \cite{bruno2007} pour s'affranchir de cette contrainte, mais complexe (POUs, \ldots) et jamais utilisé pour des surfaces en mouvement)
	\item CAO : courbes/surfaces polynomiales (algébriques)/rationnelles (en produit tensoriel) par morceaux (B-splines/NURBS), utilisant la base de Bernstein
	\begin{equation}
		B_n^N(x) = \binom{N}{n} \left( 1 - x \right)^{N-n} x^n.
	\end{equation}
	\begin{itemize}
		\item[+] coefficients = points de contrôle dans l'espace physique, sens géométrique intuitif
		\item[+] partition de l'unité sur $\berninterval$ $\Rightarrow$ propriété d'enveloppe convexe
		\item[-] algorithme d'évaluation (de Casteljau) numériquement stable mais coûteux $\bigO{N^2}$
		\item[-] points de contrôle pas \emph{sur} la courbe/surface $\Rightarrow$ pas exploitables comme marqueurs lagrangiens
		\item[-] peu pratiques pour réduire/élever le degré des polynômes
	\end{itemize}
\end{itemize}
\bigskip
on choisit les polynômes de Chebyshev\footnotemark, couramment employés dans les méthodes spectrales dans le cas non-périodique
\footnotetext{En français, le nom de ce mathématicien russe est généralement orthographié \guill{Tchebychev}. Nous utiliserons cependant l'orthographe anglo-saxone, plus couramment utilisée par la communauté scientifique.}
%(Mason, p.81) >>>-----
%Orthogonal polynomials have a great variety and wealth of properties,
%many of which are noted in this chapter. Indeed, some of these properties
%take a very concise form in the case of the Chebyshev polynomials, making
%Chebyshev polynomials of leading importance among orthogonal polynomi-
%als — second perhaps to Legendre polynomials (which have a unit weight
%function), but having the advantage over the Legendre polynomials that the
%locations of their zeros are known analytically. Moreover, along with the Legendre polynomials, the Chebyshev polynomials belong to an exclusive band
%of orthogonal polynomials, known as Jacobi polynomials, which correspond
%to weight functions of the form (1 − x) α (1 + x) β and which are solutions of
%Sturm–Liouville equations.
%The Chebyshev polynomials have further properties, which are peculiar
%to them and have a trigonometric origin, namely various kinds of discrete
%orthogonality over the zeros of Chebyshev polynomials of higher degree. In
%consequence, interpolation at Chebyshev zeros can be achieved exceptionally
%inexpensively (Chapter 6) and Gauss quadrature methods based on Cheby-
%shev zeros are extremely convenient (Chapter 8).
%<<<-----



\subsection{Polynômes de Chebyshev}
Les polynômes de Chebyshev sont très largement utilisés dans de nombreux domaines tels que l'analyse numérique.
L'objet des sections suivantes est de rappeler la définition de cette famille 
de polynômes et d'en présenter brièvement les propriétés remarquables qui seront exploitées dans cette thèse. 
Nombreux sont les ouvrages consacrés aux polynômes de Chebyshev \cite{mason2002, gil2007} ainsi qu'à leur usage dans les méthodes spectrales \cite{boyd2001, canuto2006}, aussi le lecteur est invité à s'y référer pour plus de détails.


\subsubsection{Définition}
Pour $n \in \mathbb{N}$, le polynôme de Chebyshev (de première espèce) $T_n$ est défini par%un polynome de degré $n$ défini par
\begin{equation}
	T_n(\cos \theta) = n \cos \theta.
	\label{eq:chebyshev_trigo}
\end{equation}
%De la définition \eqref{eq:chebyshev_trigo} et de l'identité trigonométrique
De cette définition et de l'identité trigonométrique $\cos n\theta + \cos (n-2)\theta = 2\cos \theta \cos (n-1)\theta$, on peut déduire la relation de récurrence suivante, pour $x \in \chebinterval$, 
\begin{align}
	T_0(x) &= 1, \nonumber\\
	T_1(x) &= x, \nonumber\\
	T_n(x) &= 2x T_{n-1}(x) - T_{n-2}(x) \text{,\ pour\ } n \geq 2.
	\label{eq:chebyshev_recurrence}
\end{align}
Le graphe des six premiers polynômes de Chebyshev est tracé sur la \autoref{fig:chebyshev_polynomials}.\par

\begin{figure}
	\centering
	\input{figures/chebyshev_polynomials.tikz}
	\caption{Graphe des premiers polynômes de Chebyshev $(n=0,\ldots,5)$ sur l'intervalle $\chebinterval$.}
	\label{fig:chebyshev_polynomials}
\end{figure}

\begin{figure}
	\centering
\begin{tikzpicture} 
	\begin{axis}[%
		width=8cm, height=6cm,
		axis lines*=left,
		xmin=-1.0, xmax=1.0, ymin=-1.0, ymax=1.0,
		grid=major,
		clip marker paths=false,
		enlargelimits={abs=0.05},
		xlabel={$x$},
		ylabel={$T_n(x)$},
		legend style={at={(1.025,0.5)}, anchor=west},
		no marks,
		samples=201,
		%cycle list/GnBu-9,%RdYlBu-6,%Spectral-6,
		%cycle multiindex* list={GnBu-9}%RdYlBu-6}%Spectral-6}
		]%
		\pgfplotsinvokeforeach{0,1,...,5}{%
      		\addplot+[domain=-1:1] { cos(#1*acos(x)) };
        	\addlegendentry{$T_{#1}$}
        }%
	\end{axis} 
\end{tikzpicture}
\caption{Graphe des premiers polynômes de Chebyshev $(n=0,\ldots,5)$ sur l'intervalle $\chebinterval$.}
%	\label{fig:chebyshev_polynomials}
\end{figure}

$T_n$ est un polynôme de degré $n$ %de coefficient dominant $2^{n-1}$ 
qui atteint ses extrema locaux sur $\chebinterval$ aux $n+1$ n\oe uds de Chebyshev-Gauss-Lobatto (CGL)%\footnote{Seuls les $n-1$ n\oe uds intérieurs sont réellement des extrema au sens où la dérivée s'y annule. A noter également que ces n\oe uds sont rangés en ordre décroissant.}
\begin{equation}
	x_k = \cos \frac{k \pi}{n},
	\label{eq:cgl_nodes}
\end{equation}
pour $0 \leq k \leq n$. 
Seuls les $n-1$ n\oe uds intérieurs sont réellement des extrema au sens où la dérivée s'y annule. 
A noter également que ces n\oe uds sont rangés en ordre décroissant.\par
Comme illustré sur la \autoref{fig:cgl_nodes}, ces extrema sont alternativement des maxima puis des minima, tous égaux en valeur absolue
\begin{equation}
	T_n(x_k) = (-1)^{k}.
	\label{eq:chebyshev_equioscillation}
\end{equation}

\begin{figure}
	\centering
	\input{figures/cgl_nodes.tikz}
%	\caption{N\oe uds de Chebyshev-Gauss-Lobatto pour $n = 6$ (extrema locaux du polynome $T_6$ sur l'intervalle $\chebinterval$).}
	\caption{N\oe uds de Chebyshev-Gauss-Lobatto (extrema locaux) du polynôme $T_5$.}% sur l'intervalle $\chebinterval$.}
	\label{fig:cgl_nodes}
\end{figure}

Cette propriété dite d'\emph{équioscillation} a pour conséquence --- via un théorème attribué au mathématicien Émile Borel --- que la meilleure approximation uniforme (\ie\ en norme $L_\infty$) polynomiale de degré $n - 1$ de la fonction $x \mapsto x^n$ sur $\chebinterval$ est la fonction $x \mapsto x^n - 2^{1 - n} T_n(x)$. \\
$\to$ économisation\ldots


\subsubsection{Approximation de fonctions}
%série $\series{f}$\\
%orthogonalité $\to$ meilleure approximation polynomiale en norme $\mathcal{L}_2$ $\to$ projeté/série tronquée $\truncseries{f}{N}$, erreur de troncature\\
%polynôme d'interpolation $\interpolant{f}{N}$, orthogonalité discrète, DCT, erreur d'aliasing \par\bigskip
Notons $\Ltwospace$ l'espace de Hilbert des fonctions de carré intégrable sur $\chebinterval$, muni du produit scalaire
\begin{equation}
	\scalprod{f}{g} =
	\int_{-1}^{1} \frac{f(x) g(x)}{\sqrt{1 - x^2}} dx.
	\label{eq:chebyshev_scalar_product}
\end{equation}

La famille des polynômes de Chebyshev est une base orthogonale de cet espace, et pour tous $m,n \in \mathbb{N}$,
\begin{equation}
	\scalprod{T_m}{T_n} =
	\frac{\pi}{2} \alpha_n \delta_{m,n},
	\label{eq:chebyshev_orthogonality}
\end{equation}
où $\delta_{\cdot,\cdot}$ représente le symbole de Kronecker, et
\begin{equation}
	\alpha_n = 
	\begin{cases}
	 2 & \text{\ si\ } n = 0,   \\ 
	 1 & \text{\ si\ } n > 0.\\ 
	\end{cases}
\end{equation}

%Le développement en série de Chebyshev $\series{f}$ d'une fonction $f \in \Ltwospace$ est défini par
Le développement en série de Chebyshev d'une fonction $f \in \Ltwospace$ est défini par
\begin{equation}
	f = \sum_{n=0}^{\infty} \hat{f}_n T_n,
	\label{eq:chebyshev_series}
\end{equation}

où les coefficients $\hat{f}_n$ sont obtenus en prenant le produit scalaire
\begin{align}
	\hat{f}_n 
	&= \frac{\scalprod{f}{T_n}}{\scalprod{T_n}{T_n}}, \nonumber \\
	&= \frac{2}{\pi \alpha_n} \int_{-1}^{1} \frac{f(x) T_n(x)}{\sqrt{1 - x^2}} dx.
	\label{eq:chebyshev_series_coeffs}
\end{align}
%le symbole $\sum{'}$ signifiant que le premier terme de la somme est divisé par 2.

Le projeté orthogonal de $f$ sur le sous-espace $\polyspace{N}$ de $\Ltwospace$ des polynômes de degré au plus $N$ est la somme partielle%série tronquée
\begin{equation}
	\truncseries{f}{N} = \sum_{n=0}^{N} \hat{f}_n T_n.
	\label{chebyshev_truncated_series}
\end{equation}

Il s'agit donc de l'élément de $\polyspace{N}$ le plus proche de $f$, au sens de la norme induite par le produit scalaire \eqref{eq:chebyshev_scalar_product}.
La somme partielle $\truncseries{f}{N}$ est également proche de la meilleure approximation uniforme de $f$ par un polynôme de degré N. En effet, si $f$ est continue sur $\chebinterval$, alors
\begin{equation}
	\norminf{f - \truncseries{f}{N}} 
	\leq 
	\left(1 + \lambda_N \right) 
	\min_{p \in \polyspace{N}} \norminf{f - p},
	\label{eq:chebyshev_near_minimax}
\end{equation}
où la constante de Lebesgue $\lambda_N = 1.27\ldots + \frac{4}{\pi^2} \log N + \bigO{1/N}$ croît %suffisamment lentement avec $N$ ($\lambda_{500} \approx 3.8$) pour que les séries de Chebyshev tronquées représentent un excellent choix pratique pour l'approximation de fonctions arbitraires.\par
lentement avec $N$ ($\lambda_{500} \approx 3.8$).\par
En outre, si $f$ possède $m$ dérivées continues sur $\chebinterval$, alors
\begin{equation}
	\norminf{f - \truncseries{f}{N}} = \bigO{N^{1-m}}.
	\label{eq:chebyshev_spectral_accuracy}
\end{equation}
En particulier, si $f \in C^{\infty}\chebinterval$, alors l'\textit{erreur de troncature} $\norminf{f - \truncseries{f}{N}}$ décroît exponentiellement avec $N$ -- 
cette caractéristique est qualifiée de \guill{précision spectrale}.
Si $f$ est suffisamment régulière, sa somme partielle $\truncseries{f}{N}$ en est donc une excellente approximation pour un faible nombre de degrés de liberté.\\
Convergence vers 0 de la suite $(\hat{f}_n)$
\par\bigskip

En pratique, l'intégrale \eqref{eq:chebyshev_series_coeffs} ne peut pas être calculée analytiquement  \ldots\\
Les polynômes de Chebyshev satisfont une seconde relation d'orthogonalité, dite \guill{discrète}, pour $0 \leq n \leq N$ et $m \geq n$,
\begin{equation}
	%\sum_{k=0}^{N}{''} T_m(x_k) T_n(x_k) = 
	\sum_{k=0}^{N} \frac{1}{\beta_k} T_m(x_k) T_n(x_k) = 
	\frac{N}{2} \beta_n \delta_{m,\pm n \bmod{2N}},
	\label{eq:chebyshev_discrete_orthogonality}
\end{equation}
%où $0 \leq m, n \leq N$ et $\family{x}{k}{0}{N}$ sont les n\oe uds CGL de $T_N$ définis par l'équation \eqref{eq:cgl_nodes}. 
où $\family{x}{k}{0}{N}$ sont les n\oe uds CGL de $T_N$ définis par l'équation \eqref{eq:cgl_nodes} et
\begin{equation}
	\beta_n = 
	\begin{cases}
	 2 & \text{\ si\ } n = 0 \text{\ ou\ } N,   \\ 
	 1 & \text{\ si\ } 0 < n < N.\\ 
	\end{cases}
\end{equation}

%Le double prime dans l'équation \eqref{eq:chebyshev_discrete_orthogonality} signifie que les premier et dernier termes de la somme sont divisés par 2.
\par


Soit $\interpolant{f}{N}$ l'unique polynôme de $\polyspace{N}$ qui interpole $f$ aux $N+1$ n\oe uds CGL de $T_N$
\begin{equation}
	\interpolant{f}{N}(x_k) = f(x_k).
	\label{eq:chebyshev_interpolation_cgl}
\end{equation}

Ce polynôme peut s'exprimer dans la base de Chebyshev
\begin{equation}
	\interpolant{f}{N} = \sum_{n=0}^{N} \tilde{f}_n T_n.
	\label{eq:chebyshev_interpolant}
\end{equation}

En utilisant les relations \eqref{eq:chebyshev_interpolant}, \eqref{eq:chebyshev_interpolation_cgl} et \eqref{eq:chebyshev_discrete_orthogonality}, on peut alors déduire les coefficients $\tilde{f}_n$ à partir des valeurs de $f$ en ces n\oe uds%aux $N+1$ n\oe uds CGL de $T_N$
\begin{equation}
	%\tilde{f}_n = \frac{2}{\beta_n N} \sum_{k=0}^{N} {''} f(x_k) \cos \frac{n k \pi}{N}.
	\tilde{f}_n = \frac{2}{\beta_n N} \sum_{k=0}^{N} \frac{1}{\beta_k} f(x_k) \cos \frac{n k \pi}{N}.
	\label{eq:chebyshev_dct}
\end{equation}

L'équation \eqref{eq:chebyshev_dct} définit ainsi une transformation discrète de l'espace \guill{physique} vers l'espace \guill{spectral}. 
Par ailleurs, des relations \eqref{eq:chebyshev_interpolation_cgl}, \eqref{eq:chebyshev_interpolant} et \eqref{eq:chebyshev_trigo}, on peut déduire la transformation inverse
\begin{equation}
	f(x_k) = \sum_{n=0}^{N} \tilde{f}_n \cos \frac{n k \pi}{N}.
	\label{eq:chebyshev_idct}
\end{equation}

Les équations \eqref{eq:chebyshev_dct} et \eqref{eq:chebyshev_idct} décrivent des transformations en cosinus discrètes (DCT), qui peuvent être effectuées efficacement à l'aide d'un algorithme de transformation de Fourier rapide (FFT) pour un coût asymptotique de $\bigO{N \log N}$ opérations.
\par
Les coefficients $\tilde{f}_n$ peuvent être reliés aux coefficients $\hat{f}_n$ par la relation
%\begin{equation}
%	\tilde{f}_n = \hat{f}_n + 
%	\quad\sum_{\mathclap{\substack{m = \pm n \bmod{2N} \\ m > N}}} \hat{f}_m.
%	%\sum_{\mathclap{\substack{m = \pm n \bmod{2N} \\ m > N}}} \hat{f}_m.
%	%\sum_{\substack{m = \pm n \bmod{2N} \\ m > N}} \hat{f}_m.
%	\label{eq:chebyshev_aliasing}
%\end{equation}
%\begin{equation}
%	\tilde{f}_n = \hat{f}_n + 
%	\sum_{\mathclap{\substack{m = \pm n \bmod{2N} \\ m > N}}} \hat{f}_m.
%\end{equation}
%\begin{equation}
%	\tilde{f}_n = \hat{f}_n + 
%	\sum_{\substack{m = \pm n \bmod{2N} \\ m > N}} \hat{f}_m.
%	\label{eq:chebyshev_aliasing}
%\end{equation}
\begin{equation}
	\tilde{f}_n = \hat{f}_n + 
	\begin{cases}
		\displaystyle\sum_{j=1}^{\infty} \hat{f}_{2jN + n} & \text{\ si\ } n = 0 \text{\ ou\ } N,   \\[4ex]
		\displaystyle\sum_{j=1}^{\infty} \left( \hat{f}_{2jN - n} + \hat{f}_{2jN + n} \right) & \text{\ si\ } 0 < n < N.\\ 
	\end{cases}
	\label{eq:chebyshev_aliasing}
\end{equation}

Cette relation met en évidence le phénomène d'\eng{aliasing}, qui traduit le fait que les polynômes $T_n$ et $T_{\pm n \bmod{2N}}$ prennent les mêmes valeurs aux n\oe uds $\family{x}{k}{0}{N}$, comme illustré sur la \autoref{fig:aliasing_cgl}.
La différence entre le polynôme d'interpolation $\interpolant{f}{N}$ et la somme partielle $\truncseries{f}{N}$ est l'\textit{erreur d'aliasing}, qui est orthogonale à l'erreur de troncature\footnote{$\normtwo{\cdot}$ désigne ici la norme induite par le produit scalaire \eqref{eq:chebyshev_scalar_product}.}
\begin{equation}
	\normtwo{f - \interpolant{f}{N}}^2 = 
	\normtwo{f - \truncseries{f}{N}}^2 + 
	\normtwo{\interpolant{f}{N} - \truncseries{f}{N}}^2.
	\label{eq:chebyshev_aliasing_esrror}
\end{equation}

L'erreur d'approximation due à l'interpolation est donc toujours supérieure à l'erreur liée à la troncature de la série de Chebyshev.
Si $f$ est régulière, la suite des coefficients $\hat{f}_n$ converge rapidement vers zéro, si bien que l'erreur d'aliasing reste faible, à condition que le degré de troncature $N$ soit choisi suffisamment grand.
En outre, de la relation \eqref{eq:chebyshev_aliasing} on déduit que pour tout $x \in \chebinterval$,
\begin{equation}
	\left| f(x) - \interpolant{f}{N}(x) \right| \leq 2 \sum_{n>N} \left| \hat{f}_n \right|.
\end{equation}
L'erreur d'approximation due à l'interpolation est donc \textit{au pire} supérieure à l'erreur de troncature par un facteur 2.
L'erreur d'aliasing peut cependant devenir problématique lorsqu'elle est amplifiée par les non-linéarités présentes dans les équations que l'on sera amené à résoudre. 
Nous reviendrons sur ce point dans la \autoref{sec:instabilites} lorsque nous aborderons \ldots


\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[%
			width=8cm, height=6cm,
			axis lines*=left,
			xmin=-1.0, xmax=1.0, ymin=-1.0, ymax=1.0,
			grid=major,
%			xtick = {-1,0,1},
%			ytick = {-1,0,1},
			clip marker paths=false,
			enlargelimits={abs=0.05},
			]%
			\addplot+[domain=-1:1, no marks, samples=100] {4*x^3 - 3*x};% T_3
			\addplot+[domain=-1:1, no marks, samples=200] {64*x^7 - 112*x^5 + 56*x^3 - 7*x};% T_7
			\addplot+[domain=-1:1, no marks, samples=500] {
			4096*x^13 - 13312*x^11 + 16640*x^9 - 9984*x^7 + 2912*x^5 - 364*x^3 + 13*x};% T_13
%			\addplot+[domain=-1:1, no marks, samples=200, black, dotted] {16*x^5 - 20*x^3 + 5*x};% T_5
			\addplot+[samples=6, domain=0:pi, ycomb, dashed, mark=*, black] ({cos(deg(x))}, {cos(3*deg(x))});% noeuds CGL de T_5
		\end{axis}
	\end{tikzpicture}
	\caption{Les polynômes $T_n$ (\protect\legenddash{s1}), $T_{2N - n}$ (\protect\legenddash{s2}) et $T_{2N + n}$ (\protect\legenddash{s3}) sont indiscernables aux n\oe uds CGL de $T_N$ ($n = 3$, $N = 5$).}
	\label{fig:aliasing_cgl}
\end{figure}


\subsubsection{Évaluation}
Par la suite, nous serons amenés à évaluer à maintes reprises des sommes de la forme
\begin{equation}
	s_N = \sum_{n=0}^N \hat{s}_n T_n.
	\label{eq:chebyshev_sum}
\end{equation}
Plutôt que de réécrire cette somme dans la base canonique de $\polyspace{N}$, il est intéressant de tirer parti de la relation \eqref{eq:chebyshev_recurrence}. 
En introduisant la suite récurrente
\begin{equation}
	b_n(x) = 
	\begin{cases}
	 0 & \text{\ si\ } n > N,   \\ 
	 \hat{s}_n - b_{n+2}(x) + 2x b_{n+1}(x) & \text{\ si\ } 0 \leq n \leq N,
	\end{cases}
\end{equation}
on obtient, pour $-1 \leq x \leq 1$,%
\def\px{}%{(x)}%
\begin{align*}
	s_N\px 
	&= \hat{s}_0 T_0\px + \hat{s}_1 T_1\px + \ldots + \hat{s}_{N-2} T_{N-2}\px + \hat{s}_{N-1} T_{N-1}\px + \hat{s}_N T_N\px, \\
	&= \hat{s}_0 T_0 \px
	+ \hat{s}_1 T_1 \px
	+ \ldots 
	+ \left(\hat{s}_{N-2} - b_{N}\px\right) T_{N-2} \px
	+ \left(\hat{s}_{N-1} - b_{N+1}\px + 2x b_{N}\px \right) T_{N-1}\px, \\
	&= \hat{s}_0 T_0 \px
	+ \hat{s}_1 T_1 \px
	+ \ldots 
	+ \left(\hat{s}_{N-3} - b_{N-1}\px\right) T_{N-3} \px
	+ b_{N-2}\px T_{N-2}\px, \\
	& \ldots\\
	&= \left( \hat{s}_0 - b_2\px \right) T_0\px + b_1\px T_1\px, \\
	&= \hat{s}_0 - b_2\px + b_1\px x,
\end{align*}
et enfin
\begin{equation}
	s_N(x) = b_0(x) - x b_1(x).
\end{equation}

L'exécution de cet algorithme de sommation --- proposé par Clenshaw \cite{clenshaw1955} --- requiert seulement $\bigO{N}$ opérations. %, ce qui le rend plus efficace que l'algorithme de Casteljau (dont la complexité est asymptotiquement quadratique). 
La sommation de Clenshaw est donc un moyen efficace et numériquement stable pour évaluer des séries de Chebyshev.


\subsubsection{Dérivation}
On note $\interpderiv{f}{N}{k}$ la dérivée $k$-ième du polynôme d'interpolation $\interpolant{f}{N}$.
Les valeurs aux n\oe uds CGL de cette dérivée peuvent être %obtenues grâce au produit
exprimées comme une combinaison linéaire des valeurs de $f$ en ces mêmes n\oe uds
\begin{equation}
	\colvec{ 
		\interpderiv{f}{N}{k}(x_0) \\ 
		\vdots \\
		\interpderiv{f}{N}{k}(x_N)
		}
	=
	{\left( D_N \right)}^k
	\colvec{ 
		f(x_0) \\ 
		\vdots \\
		f(x_N)
		},
	\label{eq:chebyshev_diff_at_cgl}
\end{equation}
où la matrice de différentiation $D_N$ est définie par%
\def\cvsp{2.5ex}
\begin{equation}
	\left( D_N \right)_{i,j} =
	\begin{cases}
	 \dfrac{2N^2 + 1}{6} & \text{\ si\ } i = j = 0,   \\[\cvsp]
	 -\dfrac{2N^2 + 1}{6} & \text{\ si\ } i = j = N,   \\[\cvsp]
	 -\dfrac{x_i}{2 \sin^2 \frac{i \pi}{N}} & \text{\ si\ } 0 < i = j < N, \\[\cvsp]
	 -\dfrac{(-1)^{i+j} \beta_i}{2 \beta_j \sin\frac{(i+j)\pi}{2N} \sin\frac{(i-j)\pi}{2N}} & \text{\ si\ } i \neq j.
	\end{cases}
	\label{eq:chebyshev_diff_matrix}
\end{equation}
%La dérivée de la somme \eqref{eq:chebyshev_sum} est un polynôme de degré au plus $N-1$, que l'on peut exprimer dans la base de Chebyshev
%\begin{equation}
%	s_{N}^{(1)}(x) = \frac{\mathrm{d} s_N}{\mathrm{d} x}(x) = \sum_{n=0}^{N-1} \hat{s}_n^{(1)} T_n(x).
%\end{equation}
La dérivée $\deriv{f}{1}$ d'une fonction $f \in C^1\chebinterval$ peut également être représentée par sa série de Chebyshev
\begin{equation}
	\deriv{f}{1} 
	= \sum_{n=1}^{\infty} \hat{f}_n T'_n
	= \sum_{n=0}^{\infty} \deriv{\hat{f}}{1}_n T_n.
	\label{eq:chebyshev_series_derivative}
\end{equation}

En posant $x = \cos\theta$, il vient, d'après \eqref{eq:chebyshev_trigo},
\begin{equation}
	T'_n(x) \equiv \dfdx{T_n(x)}{x} = \frac{n \sin n\theta}{\sin \theta}.
\end{equation}
Ainsi, de l'identité $2 \cos n \theta \sin \theta = \sin(n+1)\theta - \sin(n-1)\theta$, on peut déduire la relation 
\begin{equation}
	%T_n = \frac{1}{2} \left( \frac{1}{n+1}\dfdx{T_{n+1}}{x} - \frac{1}{n-1}\dfdx{T_{n-1}}{x} \right).
	T_n = \frac{1}{2} \left( \frac{T'_{n+1}}{n+1} - \frac{T'_{n-1}}{n-1} \right),
\end{equation}
pour $n \geq 2$. Il vient alors, pour tout $n \in \mathbb{N}$,
\begin{equation}
	2 \left( n + 1 \right) \hat{f}_{n+1} = \alpha_n \deriv{\hat{f}}{1}_n - \deriv{\hat{f}}{1}_{n+2}.
\end{equation}
%En supposant $f = \truncseries{f}{N}$ (\ie~$\hat{f}_n = 0$ pour tout $n > N$), alors %$\deriv{\hat{f}}{1}_n = 0$ pour tout $n \geq N$ et les coefficients $\deriv{\hat{f}}{1}_n$ pour $n < N$ peuvent être calculés grâce à la relation de récurrence
%les coefficients $\deriv{\hat{f}}{1}_n$ peuvent être calculés suivant la relation de récurrence
%\begin{equation}
%	\deriv{\hat{f}}{1}_n = 
%	\begin{cases}
%	 0 & \text{\ si\ } n \geq N,   \\ 
%	 \dfrac{1}{\alpha_n} \left( 2 (n + 1) \hat{f}_{n+1} + \deriv{\hat{f}}{1}_{n+2} \right) & \text{\ si\ } 0 \leq n < N.\\ 
%	\end{cases}
%	\label{eq:chebyshev_diff_recurrence}
%\end{equation}

Les coefficients $\deriv{\hat{f}}{1}_n$ peuvent ainsi être calculés suivant la relation de récurrence
\begin{equation}
	\deriv{\hat{f}}{1}_n = 
	\frac{1}{\alpha_n} \left( 2 (n + 1) \hat{f}_{n+1} + \deriv{\hat{f}}{1}_{n+2} \right).
	\label{eq:chebyshev_diff_recurrence}
\end{equation}
Plus généralement, les coefficients de Chebyshev de la dérivée $k$-ième de $f$ vérifient
\begin{equation}
	\deriv{\hat{f}}{k}_n = 
	\frac{1}{\alpha_n} \left( 2 (n + 1) \deriv{\hat{f}}{k-1}_{n+1} + \deriv{\hat{f}}{k}_{n+2} \right).
	\label{eq:chebyshev_diffp_recurrence}
\end{equation}

%\par\bigskip
%La relation \eqref{eq:chebyshev_diffp_recurrence} fournit un algorithme pour calculer \ldots 
Comme l'ont fait remarquer Wengle et Seinfeld \cite{wengle1978}, l'algorithme récursif \eqref{eq:chebyshev_diffp_recurrence} peut amplifier les erreurs d'arrondi commises sur les plus petits coefficients $\deriv{\hat{f}}{k-1}_{n}$ et ainsi compromettre la précision de \emph{tous} les coefficients $\deriv{\hat{f}}{k}_{n}$. % (même les plus grands).
%Wengle et Seinfeld \cite{wengle1978} ont remarqué que l' algorithme récursif \eqref{eq:chebyshev_diffp_recurrence} pouvait amplifier les erreurs d'arrondis commises sur les plus petits coefficients $\deriv{\hat{f}}{k-1}_{n}$, jusqu'à compromettre la précision de tous les coefficients $\deriv{\hat{f}}{k}_{n}$ .
Un moyen simple de remédier à ce problème consiste à mettre à zéro les coefficients $\deriv{\hat{f}}{k-1}_{n}$ inférieurs en valeur absolue à un seuil donné, choisi en fonction de la précision machine $\epsilon_M$.%que l'on choisit ici supérieur d'un ordre de grandeur à la précision machine.
%Remarque de \cite[Section~2.3, p~.94]{wengle1978}
(Un seuil égal à $10 \epsilon_M$ semble être un bon choix.)
\par\bigskip
Non-commutativité entre dérivation et troncature/interpolation, introduction de 
\begin{equation}
	\interpderiv{f}{N}{k} \equiv \deriv{ \left( \interpolant{f}{N} \right) }{k}.
	\label{eq:chebyshev_interpderiv}
\end{equation}
argument : on a besoin des valeurs de $\deriv{f}{k}$ et de $f$ aux mêmes n\oe uds (méthode collocation)

%L'étude menée jusqu'ici concerne l'approximation de fonctions d'une variable par des séries de Chebyshev. 
%Les résultats présentés se généralisent aux fonctions de plusieurs variables en utilisant les polynômes de Chebyshev en produit tensoriel. 
%On se limitera ici aux fonctions de deux variables, utiles pour représenter des surfaces. 
%Ainsi, une fonction $f$ continue sur $\chebinterval^2$ admet un développement en série de Chebyshev
%\begin{equation}
%	f(u,v) = \sum_{m=0}^{\infty} \sum_{n=0}^{\infty} \hat{f}_{m,n} T_m(u) T_n(v),
%\end{equation}
%dont la somme partielle
%\begin{equation}
%	\truncseries{f}{MN} (u,v) = \sum_{m=0}^{M} \sum_{n=0}^{N} \hat{f}_{m,n} T_m(u) T_n(v)
%\end{equation}
%converge uniformément vers $f$ sur $\chebinterval^2$.

%fonctions d'une variable
%\begin{itemize}
%	\item orthogonalité $\Rightarrow$ aspect multirésolution, élévation/réduction de degré directe et quasi-optimale (d'ailleurs utilisé en CAO \cite{lachance1988})
%	\item série tronquée $\truncseries{f}{N}$, erreur de troncature, précision spectrale :\\
%si $f \in C^p(\chebinterval)$, alors $\max_{\chebinterval} \left| \truncseries{f}{N} - f \right| = \bigO{N^{1-p}}$ lorsque $N \to \infty$ \cite[Théorème 5.14]{mason2002} (illustration convergence exponentielle pour $f$ analytique et décroissance exponentielle des $\hat{f}_n$)
%	\item interpolant $\interpolant{f}{N}$, erreur d'aliasing
%	\item CGL $\to$ DCT, transformation rapide
%\end{itemize}
%généralisation à plusieurs variables (produit-tensoriel)


\begin{figure}[!htp]
\centering%
%\input{figures/spectral_convergence.tikz}
\hspace*{\fill}%
\subbottom[Convergence de l'erreur maximale d'approximation due à l'interpolation par le polynôme $\interpderiv{f}{N}{k}$.]{%
\begin{tikzpicture}%
\begin{semilogyaxis}[
	width=6.7cm, height=6cm,
	xmin=0, xmax=80,
	ymin=1.0e-16, ymax=1.0e2,
	grid=both,
	axis x line*=bottom,
	axis y line*=left,
	xlabel={$N\vphantom{n}$},
	%ylabel={\small $\left \| \interpolant{f^{(k)}}{N} - f^{(k)} \right \|_{\infty} / \left \| f^{(k)} \right \|_{\infty}$},
	ylabel={\small $\norminf{\interpderiv{f}{N}{k} - \deriv{f}{k}} / \norminf{\deriv{f}{k}}$},
	xtick distance=20,
	legend pos=south west,
	legend style={font=\small},
	]%
	\addplot+ table[x index=0, y index=1] {figures/data/convergence_f.dat};%
	\addplot+ table[x index=0, y index=2] {figures/data/convergence_f.dat};%
	\addplot+ table[x index=0, y index=3] {figures/data/convergence_f.dat};%
	%\addplot+[dashed, color=black, no marks, very thick][domain=25.5:54.5] 	{1e4*exp(-0.5*x)};%
	\addplot+[dashed, color=black, no marks, very thick][domain=30:50.5]%[domain=30.5:59.5]
	 {1e6*exp(-0.53*x)};%
	%\legend{{$f$},{$f'$},{$f''$},{$e^{-0.5N}$}}%
	\legend{{$k=0$},{$k=1$},{$k=2$},{$e^{-0.53N}$}}%
\end{semilogyaxis}%
\end{tikzpicture}%
\label{subfig:spectral_convergence_Linf}%
}%
\hspace{4mm}%
%\hfill%
\subbottom[Spectre des coefficients de Chebyshev du polynôme $\interpderiv{f}{80}{k}$.]{%
\begin{tikzpicture}%
\begin{semilogyaxis}[%
	width=6.7cm, height=6cm,
	xmin=0, xmax=80,
	ymin=1.0e-16, ymax=1.0e2,
	grid=major,
	axis y line*=right,
	axis x line*=bottom,
	xlabel={$n\vphantom{N}$},
	ylabel={},
	ylabelv right={$\left | \tilde{f}_n^{(k)} \right |$},
	ylabel near ticks, 
	yticklabel pos=right,
	yticklabels={\empty},
	xtick distance=20,
	legend pos=south west,
	legend style={font=\small},
	]%
	\addplot+[only marks] table[x expr=\coordindex, y index=0] {figures/data/coeffs.dat};%
	\addplot+[only marks] table[x expr=\coordindex, y index=1] {figures/data/coeffs.dat};%
	\addplot+[only marks] table[x expr=\coordindex, y index=2] {figures/data/coeffs.dat};%
	\addplot+[dashed, color=black, no marks, very thick][domain=30:50.5]%[domain=30.5:59.5]
	 {1e6*exp(-0.53*x)};%
	%\legend{{$f$},{$f'$},{$f''$},{$e^{-0.5n}$}}%
	\legend{{$k=0$},{$k=1$},{$k=2$},{$e^{-0.53n}$}}%
\end{semilogyaxis}%
\end{tikzpicture}%
\label{subfig:spectral_convergence_coef}%
}
\hspace*{\fill}%
\caption{Précision spectrale \ldots $f : x \mapsto e^{\sin 3 x^3}$}%
\label{fig:spectral_convergence}%
\end{figure}

%\begin{figure}[!htp]
%\centering%
%\input{figures/spectral_convergence2.tikz}%
%\caption{\ldots}%
%\end{figure}
%
%\begin{figure}[!htp]
%\centering%
%\input{figures/spectral_convergence3.tikz}%
%\caption{\ldots}%
%\end{figure}

\paragraph{Représentation de courbes et de surfaces.}
Afin de représenter des courbes et surfaces plongées dans l'espace euclidien $\mathbb{R}^3$ on développe chaque composante de la paramétrisation à l'aide d'une série de Chebyshev.
Soit une courbe décrite par la paramétrisation $\bg : \chebinterval \to \mathbb{R}^3$. On notera alors
\begin{equation}
	\bg(t) = \sum_{n=0}^{\infty} \hat{\bg}_{n} T_n(t).
\end{equation}
surface $\bs : \chebinterval^2 \to \mathbb{R}^3$
\begin{equation}
	\truncseries{\bs}{MN}(u,v) = \sum_{m=0}^{M} \sum_{n=0}^{N} \hat{\bs}_{mn} T_m(u) T_n(v).
\end{equation}

%\subsubsection{Évaluation}
%algorithme de sommation de Clenshaw exploitant la relation de récurrence \eqref{eq:chebyshev_recurrence} \cite{clenshaw1955}, numériquement stable et efficace ($\bigO{N}$)

\subsubsection{Dérivation}
\begin{itemize}
	\item matrice de dérivation (espace physique)
	\item formule de récurrence (espace spectral), remarque de \cite[Section~2.3, p~.94]{wengle1978}%, \cite[p.~46]{peyret2013}
\end{itemize}

\subsubsection{Quadrature}
Clenshaw-Curtis\\
calcul longueur de courbe/aire de surface (approximation, l'intégrande n'est généralement pas polynomiale)




\section{Intégration temporelle}%{Discrétisation temporelle}
\begin{itemize}
	\item champ de vitesse connu : intégration classique, schéma explicite (Euler, RK)
	\item vitesse normale connue : approximation EdS
	\begin{itemize}
		\item calcul dérivées par différentiation spectrale
		\item calcul normale et composante tangentielle
%		\item non-linéarités $\to$ aliasing, peut causer instabilité \cite{rahimian2015}
	\end{itemize}
%	\item auto-intersections
%	\begin{itemize}
%		\item globales (traitées au chapitre 3)
%		\item locales \cite{farouki1986}
%	\end{itemize}
\end{itemize}


\section{Instabilités\ldots}
\label{sec:instabilites}
\begin{itemize}
	\item non-linéarités $\to$ aliasing, peut causer instabilité \cite{rahimian2015}, atténuation : sur-échantillonnage, filtrage
	\item auto-intersections
	\begin{itemize}
		\item globales (traitées au \autoref{chap:multi_patch})
		\item locales \cite{farouki1986} (détection, résolution?)
	\end{itemize}
\end{itemize}
